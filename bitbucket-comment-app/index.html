<!DOCTYPE html>
<html>

<head>
	<meta charset="UTF-8">
	<title>Enter Your Comment</title>
	<link rel="stylesheet" href="simplemde.min.css">
	<link rel="stylesheet" href="bootstrap.min.css">
	<script src="simplemde.min.js"></script>
	<script src="bootstrap.min.js"></script>
</head>

<body>
	<!-- All of the Node.js APIs are available in this renderer process. -->
	<!-- We are using Node.js <script>document.write(process.versions.node)</script> -->

	<textarea id="markdown-editor">
	</textarea>
	<button id="cancelBtn" type="button" class="btn btn-outline-secondary float-right" style="margin-right: 10px">Cancel</button>
	<button id="saveBtn" type="button" class="btn btn-outline-primary float-right" style="margin-right: 5px">Save</button>


	<script>
		// Editor
		var simplemde = new SimpleMDE({
			element: document.getElementById("markdown-editor"),
			autofocus: true,
			placeholder: "Write your comment..."
		});
		require('./renderer.js');
		const { ipcRenderer } = require('electron');
		// init the editor with the incoming value
		ipcRenderer.once('init.editor', function (event, arg) {
			simplemde.value(arg);
			console.log('ipcRenderer: init-editor');
		})

		var saveBtn = document.getElementById('saveBtn');
		var cancelBtn = document.getElementById('cancelBtn');

		saveBtn.addEventListener('click', function () {
			ipcRenderer.send('save.comment', simplemde.value());
		})

		cancelBtn.addEventListener('click', function () {
			ipcRenderer.send('close');
		})

		// send ui.ready message to main process when the window loaded
		window.addEventListener('load', function () {
			ipcRenderer.send('ui.ready');
		})

		// binding ESC to Cancel, and Shift+Enter to Save
		document.onkeydown = function (e) {
			e = e || window.event;
			switch (e.which || e.keyCode) {
				case 27:
					cancelBtn.click();
					break;
				case 13:
					if (e.shiftKey) {
						saveBtn.click();
					}

			}
		}
	</script>
</body>

</html>